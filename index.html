
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.4">
    
    
      
        <title>TFOD1.x Setup</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.bde7dde4.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.ef6f36e2.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL(".",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tensorflow-object-detection-v1x" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="TFOD1.x Setup" class="md-header__button md-logo" aria-label="TFOD1.x Setup" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TFOD1.x Setup
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Home
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="TFOD1.x Setup" class="md-nav__button md-logo" aria-label="TFOD1.x Setup" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    TFOD1.x Setup
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Home
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        Home
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#commands" class="md-nav__link">
    Commands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation-steps-google-colab" class="md-nav__link">
    Installation Steps (Google Colab):
  </a>
  
    <nav class="md-nav" aria-label="Installation Steps (Google Colab):">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-create-a-new-notebook-with-google-colab" class="md-nav__link">
    Step - 1: Create a new notebook with Google Colab.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-change-runtime-to-gpu" class="md-nav__link">
    Step - 2: Change runtime to GPU
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-checking-for-gpu-and-already-available-python-packages" class="md-nav__link">
    Step - 3: Checking for GPU and already available python packages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-uninstall-tensorflow-version-2x" class="md-nav__link">
    Step - 4: Uninstall Tensorflow Version 2.x
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-mount-google-drive-on-colab" class="md-nav__link">
    Step - 5: Mount Google Drive on Colab
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6-installing-tensorflow-1x-version-with-gpu" class="md-nav__link">
    Step - 6: Installing tensorflow 1.x version with GPU
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-7-checking-gpu-status-and-cuda-availability" class="md-nav__link">
    Step - 7: Checking GPU status and CUDA availability
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-8-create-a-new-folder-and-navigate-to-the-same" class="md-nav__link">
    Step - 8: Create a new folder and navigate to the same
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-9-downloading-tensorflow-models-repo" class="md-nav__link">
    Step - 9: Downloading Tensorflow Models Repo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-10-converting-protos-file-to-python-interpretor-readable-format" class="md-nav__link">
    Step - 10: Converting protos file to python interpretor readable format
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-11-installing-the-required-packages" class="md-nav__link">
    Step - 11: Installing the required packages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-12-imporing-required-packages" class="md-nav__link">
    Step - 12: Imporing Required Packages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-13-importing-utils-module" class="md-nav__link">
    Step - 13: Importing utils module
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-14-downloading-different-models-from-model-zoo" class="md-nav__link">
    Step - 14: Downloading different models from Model Zoo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-15-downloading-required-model-and-load-model-graph-pb-file" class="md-nav__link">
    Step - 15: Downloading required model and load model graph .pb file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-16-finally-loading-images-and-perform-your-first-object-detection" class="md-nav__link">
    Step - 16: Finally loading images and perform your first object detection
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation-steps-local-pc" class="md-nav__link">
    Installation Steps (Local PC):
  </a>
  
    <nav class="md-nav" aria-label="Installation Steps (Local PC):">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-setup-conda-env-refer-commands-section" class="md-nav__link">
    Step - 1: Setup conda env (Refer commands section)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-installed-required-packages" class="md-nav__link">
    Step - 2: Installed required packages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-then-follow-the-same-steps-for-running-on-google-colab-from-step-8-except-step-11-as-all-required-modules-are-installed" class="md-nav__link">
    Step - 3: Then follow the same steps for running on google colab from step - 8 (except step-11 as all required modules are installed)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-code-should-be-now-running" class="md-nav__link">
    Step - 4: Code should be now running
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-running-the-code-in-realtime-with-opencv" class="md-nav__link">
    Step - 5: Running the code in realtime with opencv
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#important-files" class="md-nav__link">
    Important Files:
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#commands" class="md-nav__link">
    Commands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation-steps-google-colab" class="md-nav__link">
    Installation Steps (Google Colab):
  </a>
  
    <nav class="md-nav" aria-label="Installation Steps (Google Colab):">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-create-a-new-notebook-with-google-colab" class="md-nav__link">
    Step - 1: Create a new notebook with Google Colab.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-change-runtime-to-gpu" class="md-nav__link">
    Step - 2: Change runtime to GPU
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-checking-for-gpu-and-already-available-python-packages" class="md-nav__link">
    Step - 3: Checking for GPU and already available python packages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-uninstall-tensorflow-version-2x" class="md-nav__link">
    Step - 4: Uninstall Tensorflow Version 2.x
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-mount-google-drive-on-colab" class="md-nav__link">
    Step - 5: Mount Google Drive on Colab
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6-installing-tensorflow-1x-version-with-gpu" class="md-nav__link">
    Step - 6: Installing tensorflow 1.x version with GPU
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-7-checking-gpu-status-and-cuda-availability" class="md-nav__link">
    Step - 7: Checking GPU status and CUDA availability
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-8-create-a-new-folder-and-navigate-to-the-same" class="md-nav__link">
    Step - 8: Create a new folder and navigate to the same
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-9-downloading-tensorflow-models-repo" class="md-nav__link">
    Step - 9: Downloading Tensorflow Models Repo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-10-converting-protos-file-to-python-interpretor-readable-format" class="md-nav__link">
    Step - 10: Converting protos file to python interpretor readable format
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-11-installing-the-required-packages" class="md-nav__link">
    Step - 11: Installing the required packages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-12-imporing-required-packages" class="md-nav__link">
    Step - 12: Imporing Required Packages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-13-importing-utils-module" class="md-nav__link">
    Step - 13: Importing utils module
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-14-downloading-different-models-from-model-zoo" class="md-nav__link">
    Step - 14: Downloading different models from Model Zoo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-15-downloading-required-model-and-load-model-graph-pb-file" class="md-nav__link">
    Step - 15: Downloading required model and load model graph .pb file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-16-finally-loading-images-and-perform-your-first-object-detection" class="md-nav__link">
    Step - 16: Finally loading images and perform your first object detection
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation-steps-local-pc" class="md-nav__link">
    Installation Steps (Local PC):
  </a>
  
    <nav class="md-nav" aria-label="Installation Steps (Local PC):">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-setup-conda-env-refer-commands-section" class="md-nav__link">
    Step - 1: Setup conda env (Refer commands section)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-installed-required-packages" class="md-nav__link">
    Step - 2: Installed required packages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-then-follow-the-same-steps-for-running-on-google-colab-from-step-8-except-step-11-as-all-required-modules-are-installed" class="md-nav__link">
    Step - 3: Then follow the same steps for running on google colab from step - 8 (except step-11 as all required modules are installed)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-code-should-be-now-running" class="md-nav__link">
    Step - 4: Code should be now running
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-running-the-code-in-realtime-with-opencv" class="md-nav__link">
    Step - 5: Running the code in realtime with opencv
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#important-files" class="md-nav__link">
    Important Files:
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="tensorflow-object-detection-v1x">Tensorflow Object Detection v1.x</h1>
<hr />
<p>The project demonstrates setup and installation of Tensorflow Object Detection version 1.x.<br />
Please find Colab Notebook <a href="https://github.com/Rahulgarg95/tfod1/blob/main/TFOD1_Setup.ipynb">github</a>.</p>
<h2 id="commands">Commands</h2>
<hr />
<ul>
<li><code>conda create -n your_env_name python=3.6 -y</code>:    Create a new Conda Env</li>
<li><code>conda env list</code>:     Listing all the conda env on Local PC.</li>
<li><code>conda activate your_env_name</code>:   Activate existing conda env</li>
</ul>
<h2 id="installation-steps-google-colab">Installation Steps (Google Colab):</h2>
<hr />
<h4 id="step-1-create-a-new-notebook-with-google-colab"><em>Step - 1: Create a new notebook with Google Colab.</em></h4>
<pre><code>1. Visit Colab Website -&gt; https://colab.research.google.com/notebooks/intro.ipynb
2. File &gt; New notebook
</code></pre>
<h4 id="step-2-change-runtime-to-gpu"><em>Step - 2: Change runtime to GPU</em></h4>
<pre><code>Runtime &gt; Change runtime type &gt; Hardware accelerator &gt; GPU
</code></pre>
<h4 id="step-3-checking-for-gpu-and-already-available-python-packages"><em>Step - 3: Checking for GPU and already available python packages</em></h4>
<pre><code>!nvidia-smi
!pip freeze
</code></pre>
<h4 id="step-4-uninstall-tensorflow-version-2x"><em>Step - 4: Uninstall Tensorflow Version 2.x</em></h4>
<pre><code>!pip uninstall tensorflow==2.4.1    # Uninstalling TF2.x
</code></pre>
<h4 id="step-5-mount-google-drive-on-colab"><em>Step - 5: Mount Google Drive on Colab</em></h4>
<pre><code>from google.colab import drive
drive.mount('/content/drive')   # Mounting drive on google colab
</code></pre>
<h4 id="step-6-installing-tensorflow-1x-version-with-gpu"><em>Step - 6: Installing tensorflow 1.x version with GPU</em></h4>
<pre><code>!pip install tensorflow-gpu==1.14.0
import tensorflow as tf     # Some warnings will generate ignore the same
print(tf.__version__)       # Checking Tensorflow Version
</code></pre>
<h4 id="step-7-checking-gpu-status-and-cuda-availability"><em>Step - 7: Checking GPU status and CUDA availability</em></h4>
<pre><code>tf.test.is_gpu_available(
cuda_only=False, min_cuda_compute_capability=None
)

tf.test.is_built_with_cuda()
</code></pre>
<h4 id="step-8-create-a-new-folder-and-navigate-to-the-same"><em>Step - 8: Create a new folder and navigate to the same</em></h4>
<pre><code>%cd /content/drive/MyDrive/TFOD1.x
!pwd
</code></pre>
<h4 id="step-9-downloading-tensorflow-models-repo"><em>Step - 9: Downloading Tensorflow Models Repo</em></h4>
<pre><code>!wget https://github.com/tensorflow/models/archive/v1.13.0.zip
!ls -lrth   # Check if the files are downloaded
!unzip v1.13.0.zip  #Unzipping the downloaded folder
!mv models-1.13.0/ models   # Rename models-1.13.0 to models
%cd models/research
</code></pre>
<h4 id="step-10-converting-protos-file-to-python-interpretor-readable-format"><em>Step - 10: Converting protos file to python interpretor readable format</em></h4>
<pre><code>%cd /content/drive/My Drive/TFOD1.x/models/research
!protoc object_detection/protos/*.proto --python_out=.
</code></pre>
<h4 id="step-11-installing-the-required-packages"><em>Step - 11: Installing the required packages</em></h4>
<pre><code>%cd /content/drive/MyDrive/mytest/models/research
!python setup.py install    # Install object detection
</code></pre>
<h4 id="step-12-imporing-required-packages"><em>Step - 12: Imporing Required Packages</em></h4>
<pre><code>import numpy as np
import os
import six.moves.urllib as urllib
import sys
import tarfile
import tensorflow as tf
import zipfile

from distutils.version import StrictVersion
from collections import defaultdict
from io import StringIO
from matplotlib import pyplot as plt
from PIL import Image

# This is needed since the notebook is stored in the object_detection folder.
sys.path.append("..")
from object_detection.utils import ops as utils_ops

if StrictVersion(tf.__version__) &lt; StrictVersion('1.9.0'):
raise ImportError('Please upgrade your TensorFlow installation to v1.9.* or later!')

# This is needed to display the images.
%matplotlib inline
</code></pre>
<h4 id="step-13-importing-utils-module"><em>Step - 13: Importing utils module</em></h4>
<pre><code>from utils import label_map_util
from utils import visualization_utils as vis_util
</code></pre>
<h4 id="step-14-downloading-different-models-from-model-zoo"><em>Step - 14: Downloading different models from Model Zoo</em></h4>
<pre><code>#https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/tf1_detection_zoo.md  #Link For Model Zoo Repository
#http://download.tensorflow.org/models/object_detection/faster_rcnn_inception_v2_coco_2018_01_28.tar.gz
MODEL_NAME = 'ssd_mobilenet_v1_coco_2017_11_17'
#MODEL_NAME = 'faster_rcnn_inception_v2_coco_2018_01_28'
MODEL_FILE = MODEL_NAME + '.tar.gz'
DOWNLOAD_BASE = 'http://download.tensorflow.org/models/object_detection/'

# Path to frozen detection graph. This is the actual model that is used for the object detection.
PATH_TO_FROZEN_GRAPH = MODEL_NAME + '/frozen_inference_graph.pb'

# List of the strings that is used to add correct label for each box.
PATH_TO_LABELS = os.path.join('data', 'mscoco_label_map.pbtxt')
</code></pre>
<h4 id="step-15-downloading-required-model-and-load-model-graph-pb-file"><em>Step - 15: Downloading required model and load model graph .pb file</em></h4>
<pre><code>opener = urllib.request.URLopener()
opener.retrieve(DOWNLOAD_BASE + MODEL_FILE, MODEL_FILE)
tar_file = tarfile.open(MODEL_FILE)
for file in tar_file.getmembers():
file_name = os.path.basename(file.name)
if 'frozen_inference_graph.pb' in file_name:
    tar_file.extract(file, os.getcwd())

detection_graph = tf.Graph()
with detection_graph.as_default():
od_graph_def = tf.GraphDef()
with tf.gfile.GFile(PATH_TO_FROZEN_GRAPH, 'rb') as fid:
    serialized_graph = fid.read()
    od_graph_def.ParseFromString(serialized_graph)
    tf.import_graph_def(od_graph_def, name='')

category_index = label_map_util.create_category_index_from_labelmap(PATH_TO_LABELS, use_display_name=True)
</code></pre>
<p><em>Note: All images for which object detection needs to be triggered are present on path: <code>object_detection/test_images</code></em></p>
<h4 id="step-16-finally-loading-images-and-perform-your-first-object-detection"><em>Step - 16: Finally loading images and perform your first object detection</em></h4>
<pre><code>def load_image_into_numpy_array(image):
    (im_width, im_height) = image.size
    return np.array(image.getdata()).reshape(
        (im_height, im_width, 3)).astype(np.uint8)


# For the sake of simplicity we will use only 2 images:
# image1.jpg
# image2.jpg
# If you want to test the code with your images, just add path to the images to the TEST_IMAGE_PATHS.
PATH_TO_TEST_IMAGES_DIR = 'test_images'
# Incase More images are added changes to be made here accordingly.
TEST_IMAGE_PATHS = [ os.path.join(PATH_TO_TEST_IMAGES_DIR, 'image{}.jpg'.format(i)) for i in range(1, 3) ]

# Size, in inches, of the output images.
IMAGE_SIZE = (12, 8)


def run_inference_for_single_image(image, graph):
    with graph.as_default():
        with tf.Session() as sess:
        # Get handles to input and output tensors
        ops = tf.get_default_graph().get_operations()
        all_tensor_names = {output.name for op in ops for output in op.outputs}
        tensor_dict = {}
        for key in [
            'num_detections', 'detection_boxes', 'detection_scores',
            'detection_classes', 'detection_masks'
        ]:
            tensor_name = key + ':0'
            if tensor_name in all_tensor_names:
            tensor_dict[key] = tf.get_default_graph().get_tensor_by_name(
                tensor_name)
        if 'detection_masks' in tensor_dict:
            # The following processing is only for single image
            detection_boxes = tf.squeeze(tensor_dict['detection_boxes'], [0])
            detection_masks = tf.squeeze(tensor_dict['detection_masks'], [0])
            # Reframe is required to translate mask from box coordinates to image coordinates and fit the image size.
            real_num_detection = tf.cast(tensor_dict['num_detections'][0], tf.int32)
            detection_boxes = tf.slice(detection_boxes, [0, 0], [real_num_detection, -1])
            detection_masks = tf.slice(detection_masks, [0, 0, 0], [real_num_detection, -1, -1])
            detection_masks_reframed = utils_ops.reframe_box_masks_to_image_masks(
                detection_masks, detection_boxes, image.shape[0], image.shape[1])
            detection_masks_reframed = tf.cast(
                tf.greater(detection_masks_reframed, 0.5), tf.uint8)
            # Follow the convention by adding back the batch dimension
            tensor_dict['detection_masks'] = tf.expand_dims(
                detection_masks_reframed, 0)
        image_tensor = tf.get_default_graph().get_tensor_by_name('image_tensor:0')

        # Run inference
        output_dict = sess.run(tensor_dict,
                                feed_dict={image_tensor: np.expand_dims(image, 0)})

        # all outputs are float32 numpy arrays, so convert types as appropriate
        output_dict['num_detections'] = int(output_dict['num_detections'][0])
        output_dict['detection_classes'] = output_dict[
            'detection_classes'][0].astype(np.uint8)
        output_dict['detection_boxes'] = output_dict['detection_boxes'][0]
        output_dict['detection_scores'] = output_dict['detection_scores'][0]
        if 'detection_masks' in output_dict:
            output_dict['detection_masks'] = output_dict['detection_masks'][0]
    return output_dict


% matplotlib inline
for image_path in TEST_IMAGE_PATHS:
image = Image.open(image_path)
# the array based representation of the image will be used later in order to prepare the
# result image with boxes and labels on it.
image_np = load_image_into_numpy_array(image)
# Expand dimensions since the model expects images to have shape: [1, None, None, 3]
image_np_expanded = np.expand_dims(image_np, axis=0)
# Actual detection.
output_dict = run_inference_for_single_image(image_np, detection_graph)
# Visualization of the results of a detection.
vis_util.visualize_boxes_and_labels_on_image_array(
    image_np,
    output_dict['detection_boxes'],
    output_dict['detection_classes'],
    output_dict['detection_scores'],
    category_index,
    instance_masks=output_dict.get('detection_masks'),
    use_normalized_coordinates=True,
    line_thickness=8)
plt.figure(figsize=(30,40))
plt.imshow(image_np)
</code></pre>
<h2 id="installation-steps-local-pc">Installation Steps (Local PC):</h2>
<hr />
<h4 id="step-1-setup-conda-env-refer-commands-section"><em>Step - 1: Setup conda env (Refer commands section)</em></h4>
<h4 id="step-2-installed-required-packages"><em>Step - 2: Installed required packages</em></h4>
<pre><code>pip install pillow lxml Cython contextlib2 jupyter matplotlib pandas opencv-python tensorflow==1.14.0
conda install -c anaconda protobuf
</code></pre>
<h4 id="step-3-then-follow-the-same-steps-for-running-on-google-colab-from-step-8-except-step-11-as-all-required-modules-are-installed"><em>Step - 3: Then follow the same steps for running on google colab from step - 8 (except step-11 as all required modules are installed)</em></h4>
<h4 id="step-4-code-should-be-now-running"><em>Step - 4: Code should be now running</em></h4>
<h4 id="step-5-running-the-code-in-realtime-with-opencv"><em>Step - 5: Running the code in realtime with opencv</em></h4>
<pre><code>import cv2
cap = cv2.VideoCapture(0)
with detection_graph.as_default():
with tf.Session(graph=detection_graph) as sess:
    while True:
    ret, image_np = cap.read()
    #Expands dimensions since the model expects images to have a shape [1, None, None, 3]
    image_np_expanded = np.expand_dims(image_np, axis=0)
    image_tensor = detection_graph.get_tensor_by_name('image_tensor:0')

    #Each box represents a part of image where a particular object was detected.
    boxes = detection_graph.get_tensor_by_name('detection_boxes:0')
    scores = detection_graph.get_tensor_by_name('detection_scores:0')
    classes = detection_graph.get_tensor_by_name('detection_classes:0')
    num_detections = detection_graph.get_tensor_by_name('num_detections:0')

    #Actual detection
    (boxes, scores, classes, num_detections) = sess.run([boxes, scores, classes, num_detections], feed_dict={image_tensor: image_np_expanded})

    #Visualization of results of a detection
    vis_util.visualize_boxes_and_labels_on_image_array(
        image_np,
        np.squeeze(boxes),
        np.squeeze(classes).astype(np.int32),
        np.squeeze(scores),
        category_index,
        use_normalized_coordinates = True,
        line_thickness = 8)

    cv2.imshow('object detection', cv2.resize(image_np, (800,600)))
    if cv2.waitKey(25) &amp; 0xFF == ord('q'):
        cv2.destroyAllWindows()
        break
</code></pre>
<h2 id="important-files">Important Files:</h2>
<ul>
<li><code>frozen_interference_graph.pb</code></li>
<li><code>object_detection_tutorial.ipynb</code></li>
<li><code>mscoco_label_map.pbtxt</code>: models\research\object_detection\data</li>
<li><code>*.config files</code>: \models\research\object_detection\samples\configs</li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://twitter.com/iamrahul95" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://github.com/Rahulgarg95" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://medium.com/" target="_blank" rel="noopener" title="medium.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M0 32v448h448V32H0zm372.2 106.1-24 23c-2.1 1.6-3.1 4.2-2.7 6.7v169.3c-.4 2.6.6 5.2 2.7 6.7l23.5 23v5.1h-118V367l24.3-23.6c2.4-2.4 2.4-3.1 2.4-6.7V199.8l-67.6 171.6h-9.1L125 199.8v115c-.7 4.8 1 9.7 4.4 13.2l31.6 38.3v5.1H71.2v-5.1l31.6-38.3c3.4-3.5 4.9-8.4 4.1-13.2v-133c.4-3.7-1-7.3-3.8-9.8L75 138.1V133h87.3l67.4 148L289 133.1h83.2v5z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.linkedin.com/in/rahulgarg95/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.sections"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "assets/javascripts/workers/search.4fa0e4ee.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.1d3bfcf1.min.js"></script>
      
    
  </body>
</html>